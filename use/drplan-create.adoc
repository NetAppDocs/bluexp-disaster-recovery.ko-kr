---
sidebar: sidebar 
permalink: use/drplan-create.html 
keywords: disaster recovery, bluexp disaster recovery, failover, failback, replicate, fail over, fail back, vmware, vcenter, replication plan, protection, disaster, recovery, virtual machines, vm 
summary: NetApp BlueXP 재해 복구 서비스는 재해 복구 워크플로우를 자동화하는 클라우드 기반 재해 복구 서비스입니다. vCenter 사이트를 추가한 후에는 재해 복구 또는 복제 계획을 생성할 수 있습니다. 
---
= 복제 계획을 생성합니다
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/use/


[role="lead"]
vCenter 사이트를 추가한 후에는 재해 복구 또는 _replication plan_을 생성할 수 있습니다. 소스 및 대상 vCenter를 선택하고 리소스 그룹을 선택한 다음 애플리케이션을 복구하고 전원을 켜는 방법을 그룹화합니다. 예를 들어, 하나의 애플리케이션과 연결된 가상 머신(VM)을 그룹화하거나 비슷한 계층이 있는 애플리케이션을 그룹화할 수 있습니다.

이러한 계획은 _bluetprints_라고도 합니다.

복제 계획을 생성하고 규정 준수 및 테스트를 위한 일정을 편집할 수도 있습니다.

여러 데이터 저장소에 있는 여러 VM을 보호할 수 있습니다. BlueXP  재해 복구에서는 보호된 VM 데이터 저장소를 호스팅하는 모든 ONTAP 볼륨에 대해 ONTAP 정합성 보장 그룹을 생성합니다.

복제 계획이 다음 상태 중 하나일 경우에만 VM을 보호할 수 있습니다.

* 새로운
* 페일백이 커밋되었습니다
* 테스트 대체 작동이 커밋되었습니다




== 계획을 작성합니다

마법사는 다음 단계를 안내합니다.

* vCenter Server 를 선택합니다.
* 리소스 그룹을 복제하고 할당할 VM 또는 데이터 저장소를 선택합니다.
* 소스 환경의 리소스가 대상에 매핑되는 방식을 매핑합니다.
* 재발을 식별하고, 게스트 호스팅 스크립트를 실행하고, 부팅 순서를 설정하고, 복구 지점 목표를 선택합니다.
* 계획을 검토합니다.


계획을 만들 때는 다음 지침을 따라야 합니다.

* 계획의 모든 VM에 대해 동일한 자격 증명을 사용합니다.
* 계획의 모든 VM에 대해 동일한 스크립트를 사용합니다.
* 계획의 모든 VM에 대해 동일한 서브넷, DNS 및 게이트웨이를 사용합니다.


.시작하기 전에
이 서비스에서 SnapMirror 관계를 생성하려면 클러스터와 SVM 피어링을 BlueXP 재해 복구 외부에서 이미 설정한 상태여야 합니다.



=== vCenter Server 를 선택합니다

먼저 소스 vCenter를 선택한 다음 대상 vCenter를 선택합니다.

.단계
. BlueXP 왼쪽 NAV에서 * Protection * > * Disaster Recovery * 를 선택합니다.
. BlueXP  재해 복구 상단 메뉴에서 * 복제 계획 * 을 선택하고 * 추가 * 를 선택합니다. 또는 서비스를 사용하기 시작한 경우 대시보드에서 * 복제 계획 추가 * 를 선택합니다.
+
image:dr-plan-create-name.png["복제 계획 추가 및 GT, 계획 추가 페이지를 보여 주는 스크린샷"]

. 복제 계획의 이름을 생성합니다.
. 소스 및 타겟 vCenter 목록에서 소스 및 타겟 vCenter를 선택합니다.
. 다음 * 을 선택합니다.




=== 리소스 그룹을 복제하고 할당할 애플리케이션을 선택합니다

다음 단계는 필요한 VM 또는 데이터 저장소를 기능 리소스 그룹으로 그룹화하는 것입니다. 리소스 그룹을 사용하면 공통 스냅샷을 사용하여 VM 또는 데이터 저장소 집합을 보호할 수 있습니다.

복제 계획에서 애플리케이션을 선택하면 계획에서 각 VM 또는 데이터 저장소에 대한 운영 체제를 볼 수 있습니다. 이 기능은 리소스 그룹에서 VM 또는 데이터 저장소를 그룹화하는 방법을 결정하는 데 유용합니다.


TIP: 각 리소스 그룹에는 하나 이상의 VM 또는 데이터 저장소가 포함될 수 있습니다.

자원 그룹을 만들 때는 다음과 같은 문제를 고려하십시오.

* 리소스 그룹에 데이터 저장소를 추가하기 전에 먼저 수동 검색 또는 예약된 VM 검색을 시작합니다. 이렇게 하면 VM이 검색되고 리소스 그룹에 나열됩니다. 수동 검색을 트리거하지 않으면 VM이 리소스 그룹에 나열되지 않을 수 있습니다.
* 데이터 저장소에 하나 이상의 VM이 있는지 확인합니다. 데이터 저장소에 VM이 없으면 데이터 저장소가 검색되지 않습니다.
* 단일 데이터 저장소는 둘 이상의 복제 계획으로 보호되는 VM을 호스팅해서는 안 됩니다.
* 보호된 VM과 보호되지 않은 VM을 동일한 데이터 저장소에 호스팅하지 마십시오. 보호된 VM과 보호되지 않는 VM이 동일한 데이터 저장소에 호스팅되는 경우 다음과 같은 문제가 발생할 수 있습니다.
+
** BlueXP  재해 복구는 SnapMirror를 사용하고 시스템은 전체 ONTAP 볼륨을 복제하므로 해당 볼륨의 사용된 용량이 라이센스 고려 사항에 사용됩니다. 이 경우 보호된 VM과 보호되지 않은 VM 모두에서 사용되는 볼륨 공간이 이 계산에 포함됩니다.
** 리소스 그룹 및 관련 데이터 저장소를 재해 복구 사이트로 페일오버해야 하는 경우 보호되지 않는 VM(리소스 그룹에 속하지 않지만 ONTAP 볼륨에서 호스팅됨)이 페일오버 프로세스에서 소스 사이트에 더 이상 존재하지 않아 소스 사이트에서 보호되지 않는 VM에 장애가 발생합니다. 또한 BlueXP  재해 복구는 페일오버 vCenter 사이트에서 보호되지 않는 VM을 시작하지 않습니다.


* VM을 보호하려면 VM을 리소스 그룹에 포함해야 합니다.


* 모범 사례 *: BlueXP  재해 복구를 배포하기 전에 VM을 구성하여 "데이터 저장소 스프롤"을 최소화합니다. 보호가 필요한 VM을 데이터 저장소의 하위 집합에 배치하고 보호되지 않는 VM을 데이터 저장소의 다른 하위 집합에 배치합니다. 데이터 저장소 기반 보호를 사용하여 지정된 데이터 저장소에 있는 VM을 보호합니다.

.단계
. Virtual Machines * 또는 * Datastores * 를 선택합니다.
. 선택적으로 이름으로 특정 VM 또는 데이터 저장소를 검색합니다.
. 애플리케이션 페이지의 왼쪽에서 보호하고 선택한 그룹에 할당할 VM 또는 데이터 저장소를 선택합니다.
+
선택한 리소스가 그룹 1에 자동으로 추가되고 새 그룹 2가 시작됩니다. 마지막 그룹에 자원을 추가할 때마다 다른 그룹이 추가됩니다.

+
image:dr-plan-create-apps-vms6.png["복제 계획 및 GT, 복제할 애플리케이션 추가 페이지를 보여 주는 스크린샷"]

+
또는 데이터 저장소의 경우:

+
image:dr-plan-create-apps-datastores.png["복제 계획 및 GT, 복제할 애플리케이션 추가 페이지를 보여 주는 스크린샷"]

. 필요에 따라 다음 중 하나를 실행합니다.
+
** 그룹 이름을 변경하려면 그룹 * 편집 * 아이콘을 클릭합니다image:icon-pencil.png["연필 아이콘"].
** 그룹에서 자원을 제거하려면 자원 옆의 * X * 를 선택합니다.
** 리소스를 다른 그룹으로 이동하려면 새 그룹으로 끌어 놓습니다.
+

TIP: 데이터 저장소를 다른 리소스 그룹으로 이동하려면 원치 않는 데이터 저장소의 선택을 취소하고 복제 계획을 제출합니다. 그런 다음 다른 복제 계획을 생성하거나 편집하고 데이터 저장소를 다시 선택합니다.



. 다음 * 을 선택합니다.




=== 소스 리소스를 대상에 매핑합니다

리소스 매핑 단계에서 소스 환경의 리소스가 타겟에 매핑되는 방법을 지정합니다. 복제 계획을 생성할 때 계획의 각 VM에 대해 부팅 지연 및 순서를 설정할 수 있습니다. 따라서 VM이 시작될 순서를 설정할 수 있습니다.

.시작하기 전에
이 서비스에서 SnapMirror 관계를 생성하려면 클러스터와 SVM 피어링을 BlueXP 재해 복구 외부에서 이미 설정한 상태여야 합니다.

.단계
. 리소스 매핑 페이지에서 페일오버 및 테스트 작업 모두에 동일한 매핑을 사용하려면 확인란을 선택합니다.
+
image:dr-plan-resource-mapping2.png["복제 계획, 리소스 매핑 탭"]

. 페일오버 매핑 탭에서 각 리소스의 오른쪽에 있는 아래쪽 화살표를 선택하고 각 리소스의 리소스를 매핑합니다.
. * Compute resources *: * Compute resources * 옆에 있는 아래쪽 화살표를 선택합니다.
+
** * 소스 및 타겟 데이터 센터 *
** * 대상 클러스터 *
** * 대상 호스트 * (선택 사항): 클러스터를 선택한 후 이 정보를 설정할 수 있습니다.
+

TIP: vCenter에 클러스터의 여러 호스트를 관리하도록 구성된 DRS(Distributed Resource Scheduler)가 있는 경우 호스트를 선택할 필요가 없습니다. 호스트를 선택하면 BlueXP  재해 복구에서 모든 VM을 선택한 호스트에 배치합니다.

** * 대상 VM 폴더 * (선택 사항): 선택한 VM을 저장할 새 루트 폴더를 만듭니다.


. * 가상 네트워크 *: 장애 조치 매핑 탭에서 * 가상 네트워크 * 옆에 있는 아래쪽 화살표를 선택합니다. 소스 가상 LAN과 대상 가상 LAN을 선택합니다.
+
적절한 가상 LAN에 대한 네트워크 매핑을 선택합니다. 가상 LAN은 이미 프로비저닝되어야 하므로 적절한 가상 LAN을 선택하여 VM을 매핑합니다.

. * 가상 머신 *: 페일오버 매핑 탭에서 * 가상 머신 * 옆에 있는 아래쪽 화살표를 선택합니다.
+
VM의 기본값이 매핑됩니다. 기본 매핑은 VM이 운영 환경에서 사용하는 것과 동일한 설정(동일한 IP 주소, 서브넷 마스크 및 게이트웨이)을 사용합니다.

+
기본 설정에서 변경한 경우 대상 IP 필드를 "원본과 다름"으로 변경해야 합니다.

+

NOTE: 설정을 "소스와 다름"으로 변경하는 경우 VM 게스트 OS 자격 증명을 제공해야 합니다.

+
이 섹션에는 선택에 따라 다른 필드가 표시될 수 있습니다.

+
** * IP 주소 유형 *: 대상 가상 네트워크 요구 사항에 맞게 VM 구성을 재구성합니다. BlueXP  재해 복구는 DHCP 또는 고정 IP의 두 가지 옵션을 제공합니다. 정적 IP의 경우 서브넷 마스크, 게이트웨이 및 DNS 서버를 구성합니다. 또한 VM에 대한 자격 증명을 입력합니다.
+
*** * DHCP *: VM이 DHCP 서버에서 네트워크 구성 정보를 얻도록 하려면 이 설정을 선택합니다. 이 옵션을 선택하면 VM에 대한 자격 증명만 제공합니다.
*** * 정적 IP *: IP 구성 정보를 수동으로 지정하려면 이 설정을 선택합니다. 소스와 동일, 소스와 다름 또는 서브넷 매핑 중 하나를 선택할 수 있습니다. 원본과 동일한 을 선택하면 자격 증명을 입력할 필요가 없습니다. 반면 원본과 다른 정보를 사용하도록 선택한 경우 자격 증명, VM의 IP 주소, 서브넷 마스크, DNS 및 게이트웨이 정보를 제공할 수 있습니다. VM 게스트 OS 자격 증명은 글로벌 레벨 또는 각 VM 레벨에 제공해야 합니다.
+
이 기능은 대규모 환경을 소규모 대상 클러스터로 복구하거나 일대일 물리적 VMware 인프라를 프로비저닝하지 않고도 재해 복구 테스트를 수행할 때 매우 유용합니다.

+
image:dr-plan-create-mapping-vms2.png["복제 계획 추가 및 GT, 리소스 매핑 및 GT, 가상 머신을 보여 주는 스크린샷"]



** * 스크립트 *: 사후 장애 조치 프로세스로 .sh, .bat 또는 .ps1 형식의 사용자 정의 스크립트를 포함할 수 있습니다. 사용자 지정 스크립트를 사용하면 페일오버 프로세스 후에 BlueXP 재해 복구로 스크립트를 실행할 수 있습니다. 예를 들어, 페일오버가 완료된 후 사용자 지정 스크립트를 사용하여 모든 데이터베이스 트랜잭션을 재개할 수 있습니다.
** * 대상 VM 접두사 및 접미사 *: 가상 머신 세부 정보 아래에서 선택적으로 VM 이름에 접두사와 접미사를 추가할 수 있습니다.
** * 소스 VM CPU 및 RAM *: 가상 머신 세부 정보 아래에서 선택적으로 VM CPU 및 RAM 매개 변수의 크기를 조정할 수 있습니다.
+
image:dr-plan-resource-mapping-vm-boot-order.png["복제 계획 추가 및 GT, 리소스 매핑 및 GT, 가상 머신을 보여 주는 스크린샷"]

** * 부트 순서 *: 리소스 그룹에서 선택한 모든 가상 머신에 대한 대체 작동 후 부트 순서를 수정할 수 있습니다. 기본적으로 모든 VM은 병렬로 함께 부팅되지만 이 단계에서 변경할 수 있습니다. 이는 후속 우선 순위 VM이 시작되기 전에 우선 순위 VM이 모두 실행되도록 하는 데 유용합니다.
+
부팅 순서 번호가 동일한 VM은 병렬로 부팅됩니다.

+
*** 순차적 부팅: 할당된 순서대로 각 VM에 고유한 번호를 할당합니다(예: 1,2,3,4,5).
*** 동시 부팅: VM에 동일한 번호를 할당하여 동시에 부팅합니다(예: 1,1, 1,1, 2,2, 3,4, 4).


** * 부팅 지연 * : 부팅 작업의 지연 시간(분)을 조정합니다.
+

TIP: 부팅 순서를 기본값으로 재설정하려면 * VM 설정을 기본값으로 재설정 * 을 선택한 다음 기본값으로 다시 변경할 설정을 선택합니다.

** * 애플리케이션 정합성이 보장되는 복제본 생성 *: 애플리케이션 정합성이 보장되는 스냅샷 복제본을 생성할지 여부를 나타냅니다. 서비스는 애플리케이션을 중지한 다음 스냅샷을 생성하여 애플리케이션의 일관된 상태를 가져옵니다. 이 기능은 Windows에서 실행되는 Oracle과 Windows에서 실행되는 Linux 및 SQL Server에서 지원됩니다.


. * Datastores *: * Datastores * 옆에 있는 아래쪽 화살표를 선택합니다. 선택한 VM에 따라 데이터 저장소 매핑이 자동으로 선택됩니다.
+
이 섹션은 선택에 따라 활성화 또는 비활성화될 수 있습니다.

+
** * 플랫폼 관리 백업 및 보존 일정 사용 *: 외부 스냅샷 관리 솔루션을 사용하는 경우 이 확인란을 선택하십시오. BlueXP  재해 복구는 기본 ONTAP SnapMirror 정책 스케줄러나 타사 통합 같은 외부 스냅샷 관리 솔루션의 사용을 지원합니다. 복제 계획의 모든 데이터 저장소(볼륨)에 이미 다른 곳에서 관리되고 있는 SnapMirror 관계가 있는 경우 이러한 스냅샷을 BlueXP  재해 복구의 복구 지점으로 사용할 수 있습니다.
+
이 옵션을 선택하면 BlueXP  재해 복구가 백업 일정을 구성하지 않습니다. 그러나 테스트, 페일오버 및 페일백 작업을 위해 스냅샷을 계속 사용할 수 있으므로 보존 일정을 구성해야 합니다.

+
이 구성이 완료되면 서비스가 정기적으로 예약된 스냅샷을 만들지 않고 대신 외부 엔티티에 의존하여 해당 스냅샷을 생성하고 업데이트합니다.

** * 시작 시간 * : 백업 및 보존이 실행될 날짜와 시간을 입력합니다.
** * 실행 간격 *: 시간 간격을 분 단위로 입력합니다. 예를 들어, 1시간을 입력하면 서비스는 1시간마다 스냅샷을 생성합니다.
** * 보존 횟수 *: 보존할 스냅샷 수를 입력합니다.
** * 소스 및 타겟 데이터 저장소 *: SnapMirror 관계가 여러 개 있는 경우 사용할 대상을 선택할 수 있습니다. 볼륨에 SnapMirror 관계가 이미 설정된 경우 해당 소스 및 타겟 데이터 저장소가 나타납니다. SnapMirror 관계가 없는 볼륨의 경우, 타겟 클러스터, 타겟 SVM을 선택하고 볼륨 이름을 제공하여 지금 생성할 수 있습니다. 이 서비스는 볼륨 및 SnapMirror 관계를 생성합니다.
+

NOTE: 이 서비스에서 SnapMirror 관계를 생성하려면 클러스터와 SVM 피어링을 BlueXP 재해 복구 외부에서 이미 설정한 상태여야 합니다.

** VM이 동일한 볼륨과 동일한 SVM에서 수행되는 경우 이 서비스는 표준 ONTAP 스냅샷을 수행하고 2차 대상을 업데이트합니다.
** VM이 다른 볼륨과 동일한 SVM의 경우 모든 볼륨을 포함하여 일관성 그룹 스냅샷을 생성하고 2차 대상을 업데이트합니다.
** VM이 서로 다른 볼륨 및 SVM에서 생성된 경우, 서비스는 동일한 또는 다른 클러스터에 있는 모든 볼륨을 포함하여 일관성 그룹 시작 단계와 커밋 단계 스냅샷을 수행하고 2차 대상을 업데이트합니다.
** 페일오버 중에 스냅샷을 선택할 수 있습니다. 최신 스냅샷을 선택하면 주문형 백업이 생성되고 대상이 업데이트되며 해당 스냅샷이 페일오버에 사용됩니다.






=== 테스트 페일오버 매핑을 추가합니다

.단계
. 테스트 환경에 대해 다른 매핑을 설정하려면 확인란을 선택 취소하고 * 테스트 매핑 * 탭을 선택합니다.
. 이전과 같이 각 탭을 살펴보았지만 이번에는 테스트 환경에 대해 살펴보겠습니다.
+
테스트 매핑 탭에서 가상 머신 및 데이터 저장소 매핑이 해제됩니다.

+

TIP: 나중에 전체 계획을 테스트할 수 있습니다. 현재 테스트 환경에 대한 매핑을 설정하고 있습니다.





=== 복제 계획을 검토합니다

마지막으로 복제 계획을 잠시 살펴보겠습니다.


TIP: 나중에 복제 계획을 해제하거나 삭제할 수 있습니다.

.단계
. 계획 세부 정보, 페일오버 매핑 및 VM과 같은 각 탭의 정보를 검토합니다.
. 계획 추가 * 를 선택합니다.
+
계획이 계획 목록에 추가됩니다.





== 일정을 편집하여 규정 준수를 테스트하고 장애 조치 테스트가 작동하는지 확인합니다

규정 준수 및 장애 조치 테스트를 테스트하는 일정을 설정하여 필요할 때 올바르게 작동하는지 확인할 수 있습니다.

* * 규정 준수 시간 영향 *: 복제 계획이 생성되면 서비스가 기본적으로 규정 준수 일정을 생성합니다. 기본 준수 시간은 30분입니다. 이 시간을 변경하려면 복제 계획에서 스케줄 편집 을 사용할 수 있습니다.
* * 대체 작동 영향 테스트 * : 요청 시 또는 일정에 따라 대체 작동 프로세스를 테스트할 수 있습니다. 이렇게 하면 복제 계획에 지정된 대상에 대한 가상 시스템의 페일오버를 테스트할 수 있습니다.
+
테스트 페일오버에서는 FlexClone 볼륨을 생성하고 데이터 저장소를 마운트하며 워크로드를 해당 데이터 저장소에서 이동합니다. 테스트 페일오버 작업은 운영 워크로드, 테스트 사이트에 사용된 SnapMirror 관계, 계속 정상적으로 작동해야 하는 보호된 워크로드에 영향을 주지 않습니다.



스케줄에 따라 페일오버 테스트가 실행되고 복제 계획에서 지정한 대상으로 워크로드가 이동되는지 확인합니다.

.단계
. BlueXP 재해 복구 상단 메뉴에서 * Replication plans * 를 선택합니다.
+
image:dr-plan-list.png["복제 계획 목록을 보여 주는 스크린샷"]

. 작업 * 을 선택합니다 image:icon-horizontal-dots.png["가로 점선 작업 메뉴"] 아이콘을 클릭하고 * 일정 편집 * 을 선택합니다.
. BlueXP 재해 복구를 통해 테스트 규정 준수를 확인할 수 있는 빈도를 분 단위로 입력하십시오.
. 장애 조치 테스트가 양호한지 확인하려면 * 매월 스케줄에 장애 조치 실행 * 을 선택합니다.
+
.. 이 테스트를 실행할 날짜 및 시간을 선택합니다.
.. 검사를 시작할 날짜를 yyyy-mm-dd 형식으로 입력하십시오.
+
image:dr-plan-schedule-edit2.png["일정을 편집할 수 있는 위치를 보여 주는 스크린샷"]



. * 예약된 테스트 대체 작동에 필요 시 스냅샷 사용 *: 자동 테스트 대체 작동을 시작하기 전에 새 스냅샷을 생성하려면 이 확인란을 선택합니다.
. 장애 조치 테스트가 완료된 후 테스트 환경을 정리하려면 * 테스트 장애 조치 후 자동 정리 * 를 선택하고 정리가 시작되기 전에 대기할 시간(분)을 입력합니다.
+

NOTE: 이 프로세스에서는 임시 VM을 테스트 위치에서 등록 취소하고, 생성된 FlexClone 볼륨을 삭제하고, 임시 데이터 저장소를 마운트 해제합니다.

. 저장 * 을 선택합니다.

